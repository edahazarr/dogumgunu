<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>İyi ki Doğdun 🎉</title>

  <!-- Sosyal önizleme -->
  <meta property="og:title" content="Sana özel bir sürpriz 🎁" />
  <meta property="og:description" content="Tıkla ve sürprizini gör!" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="fotografimiz.jpeg" />

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&display=swap" rel="stylesheet" />

  <style>
    :root{ --text:#111827; --muted:#374151; --btn:#111827; --btn-text:#fff; }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:'Poppins',system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
      background:url("fotografimiz.jpeg") no-repeat center center/cover;
      color:var(--text); overflow-x:hidden;
    }
    .wrap{min-height:100%; display:grid; place-items:center; padding:28px 16px 80px; position:relative;}

    /* Şeffaf dikdörtgen kaldırıldı */
    .card{
      background: transparent !important;
      border: none !important;
      box-shadow: none !important;
      backdrop-filter: none !important;
      border-radius: 0 !important;
      padding: 0 !important;
      width: auto !important;
      transform: none !important;
      opacity: 1 !important;
      text-align: center;
    }

    .chip{display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border-radius:999px;
      background:rgba(255,255,255,.55); font-size:12px; margin-bottom:10px;}

    /* Mektup (2 kat büyük) */
    .envelope{ background:transparent; border:0; padding:0; cursor:pointer; margin:10px auto; display:block; user-select:none; }
    .envelope svg{ width:min(520px,90vw); height:auto; display:block; margin:0 auto; filter:drop-shadow(0 6px 14px rgba(0,0,0,.18)); }
    .flap{ transform-box:fill-box; transform-origin:50% 40%; transition:transform .6s cubic-bezier(.2,.8,.2,1); }
    .envelope.open .flap{ transform:rotateX(180deg); }
    .heart{ animation:pulse 1.6s ease-in-out infinite; }
    .envelope.open .heart{ animation:none; opacity:.15; }
    @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}

    /* Açıldıktan sonra çıkan pano (arkaplankalp.jpeg) */
    .mesaj-wrap{
      display:none;
      margin: 0 auto;
      padding: clamp(24px, 4vw, 48px);
      width: min(900px, 92vw);
      background: url("arkaplankalp.jpeg") center/cover no-repeat;
      border-radius: 20px;
      box-shadow: 0 10px 40px rgba(0,0,0,.18);
      text-align: center;
    }
    .mesaj-wrap.show{ display:block; }

    .mesaj-title{ font-size:clamp(28px,6vw,46px); font-weight:800; margin:8px 0 10px; }
    .mesaj-sub{ color:var(--muted); margin:0 0 14px; }
    .mesaj-text{ font-size:clamp(16px,2.4vw,20px); line-height:1.7; white-space:pre-wrap; font-weight:500; }
    .fade-in{ animation:fadeIn .9s ease forwards; opacity:0; }
    @keyframes fadeIn{ from{opacity:0; transform:scale(.98)} to{opacity:1; transform:scale(1)} }

    .actions{ display:flex; justify-content:center; flex-wrap:wrap; gap:12px; margin-top:12px; }
    .btn{ border:0; padding:12px 16px; border-radius:14px; cursor:pointer; font-weight:700;
      background:var(--btn); color:var(--btn-text); box-shadow:0 4px 14px rgba(0,0,0,.18); }
    .btn.secondary{ background:transparent; color:var(--text); border:1px dashed #9ca3af; }

    /* Balonlar */
    .balloon{position:absolute; bottom:-140px; width:28px; height:38px; border-radius:50% 50% 50% 50%/60% 60% 40% 40%;
      background:rgba(255,255,255,.85); box-shadow:inset 0 -6px 14px rgba(0,0,0,.12);
      animation:fly var(--dur) linear infinite; left:var(--left)}
    .balloon::after{content:''; position:absolute; left:50%; top:38px; width:2px; height:50px; background:rgba(255,255,255,.65); transform:translateX(-50%)}
    @keyframes fly{to{transform:translateY(-130vh) translateX(var(--drift,0px)); opacity:.95}}

    .footer{position:fixed; inset:auto 0 12px; display:flex; justify-content:center}
    .footer .chip{background:rgba(255,255,255,.4)}
  </style>
</head>
<body>
  <div class="wrap">
    <!-- Balonlar JS ile eklenecek -->
    <div class="card" id="card">
      <div class="chip" id="chip">🎂 Doğum Günü Sürprizi</div>

      <!-- Kapalı mektup -->
      <button id="envelope" class="envelope" aria-label="Mektubu aç">
        <svg viewBox="0 0 200 150" role="img" aria-labelledby="envTitle">
          <title id="envTitle">Kalpli mektup</title>
          <ellipse cx="100" cy="128" rx="68" ry="10" fill="rgba(0,0,0,.12)"/>
          <rect x="25" y="45" width="150" height="90" rx="10" fill="#ffffff"/>
          <path d="M25 60 L100 110 L175 60" fill="none" stroke="#e5e7eb" stroke-width="2"/>
          <g class="flap">
            <path d="M25 60 L100 20 L175 60 Z" fill="#ffffff" stroke="#e5e7eb" stroke-width="2"/>
            <path class="heart" d="M100 55
              c -10 -12 -28 -2 -22 12
              c 5 12 22 20 22 20
              c 0 0 17 -8 22 -20
              c 6 -14 -12 -24 -22 -12 Z"
              fill="#ef4444" />
          </g>
        </svg>
      </button>

      <!-- Açıldıktan sonra görünen pano -->
      <div id="opened" class="mesaj-wrap" aria-live="polite">
        <h1 class="mesaj-title fade-in">🎉 İyi ki doğdun, <span id="name">Aşkım ❤︎ </span>!</h1>
        
        <p class="mesaj-text fade-in" id="message">Aşkitom doğum günün kutlu olsun! 🎂✨ Seni çok seviyorum.İyi ki varsın...
Birlikte nice güzel uzun senelerimiz olsun birtanem. ❤︎ 
Senle olduğum her an için şükrediyorum.İyi ki biz iyi ki sen aşkım.♥︎ 
HAPPY BİRTHDAY AŞKİTOLARIN KRALIIII!!!♥︎♥︎♥︎♥︎</p>
        <p class="signature fade-in" id="from" style="display:none">— </p>
        <div class="actions fade-in" id="actions" style="display:none">
          <button class="btn secondary" id="confettiBtn">🎊 Konfeti</button>
          <button class="btn secondary" id="copyBtn">🔗 Linki Kopyala</button>
          <button class="btn secondary" id="musicBtn" style="display:none">▶︎ Müzik</button>
        </div>
      </div>
    </div>
    <div class="footer"><span class="chip">💡 Mektuba tıkla sevgilim!❤︎</span></div>
  </div>

  <!-- Konfeti -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>
  <script>
    const $ = (s)=>document.querySelector(s);
    const params = new URLSearchParams(location.search);
    const get = (k,d='') => params.get(k)||d;

    const p = {
      name: get('name','Dostum'),
      message: get('message',''),
      from: get('from',''),
      subtitle: get('subtitle',''),
      music: get('music','')
    };

    // Balonlar
    const wrap = document.querySelector('.wrap');
    const colors = ['#fff','#ffe4e6','#e0f2fe','#dcfce7','#ede9fe'];
    for(let i=0;i<12;i++){
      const b=document.createElement('div');
      b.className='balloon';
      b.style.setProperty('--left', Math.random()*100+'vw');
      b.style.setProperty('--dur', (10+Math.random()*10)+'s');
      b.style.background=colors[i%colors.length];
      b.style.setProperty('--drift',(Math.random()<.5?'-':'')+(10+Math.random()*20)+'px');
      wrap.appendChild(b);
    }

    // Metinleri doldur
    $('#name').textContent=p.name;
    if(p.subtitle) $('#subtitle').textContent=p.subtitle;
    if(p.message) $('#message').textContent=p.message;
    if(p.from){ const f=$('#from'); f.style.display='block'; f.textContent=`— ${p.from}`; }
    $('#chip').textContent = " Sevgilim İçin Sürpriz!🎂💋ྀིྀི";


    // Konfeti
    function popConfetti(){
      const duration=1200, end=Date.now()+duration;
      (function frame(){
        confetti({particleCount:50,startVelocity:45,spread:60,origin:{x:Math.random(),y:Math.random()*0.3+0.1}});
        if(Date.now()<end) requestAnimationFrame(frame);
      })();
    }

    // Müzik
    let audio; let playing=false;
    if(p.music){
      audio=new Audio(p.music);
      const btn=$('#musicBtn');
      btn.style.display='inline-block';
      btn.addEventListener('click',()=>{
        if(!playing){ audio.play(); btn.textContent='⏸︎ Durdur'; playing=true; }
        else { audio.pause(); btn.textContent='▶︎ Müzik'; playing=false; }
      });
    }

    // İlk animasyon
    setTimeout(()=>$('#card').classList.add('show'),200);

    // Mektup açma
    const envelope=$('#envelope');
    const opened=$('#opened');
    envelope.addEventListener('click',()=>{
      envelope.classList.add('open');
      setTimeout(()=>{
        envelope.style.display='none'; // mektup kaybolsun
        opened.classList.add('show');  // pano görünsün
        $('#actions').style.display='flex';
        popConfetti();
      },620);
    });

    // Butonlar
    $('#confettiBtn').addEventListener('click',popConfetti);
    $('#copyBtn').addEventListener('click',async()=>{
      try{
        await navigator.clipboard.writeText(location.href);
        const old=$('#copyBtn').textContent;
        $('#copyBtn').textContent='✅ Kopyalandı!';
        setTimeout(()=>$('#copyBtn').textContent=old,1500);
      }catch(e){ alert('Linki kopyalayamadım.'); }
    });
  </script>
</body>
</html>
